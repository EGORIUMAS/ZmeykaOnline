<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>–ó–º–µ–π–∫–∞ ‚Äî –û–Ω–ª–∞–π–Ω –∏ –û—Ñ—Ñ–ª–∞–π–Ω</title>
  <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/static/css/styles.css">
  <script>
    // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è WebSocket –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
    window.WS_CONFIG = {
      host: '{{ ws_host }}',
      port: '{{ ws_port }}'
    };
  </script>
</head>
<body>
  <div class="floating-bg" id="floating-bg"></div>
  
  <button class="fullscreen-btn" id="fullscreen-btn" title="–ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º">
    <span>‚õ∂</span>
  </button>
  
  <h1>–ó–º–µ–π–∫–∞ ‚Äî –ú–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è</h1>
  
  <!-- –≠–∫—Ä–∞–Ω –≤—ã–±–æ—Ä–∞ —Ä–µ–∂–∏–º–∞ -->
  <div id="mode-selection" class="screen active">
    <h2>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º</h2>
    <div class="mode-buttons">
      <button id="btn-offline" class="mode-select-btn">
        <span class="icon">üéÆ</span>
        <span>–û—Ñ—Ñ–ª–∞–π–Ω</span>
        <span class="desc">–ò–≥—Ä–∞ –Ω–∞ –æ–¥–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ</span>
      </button>
      <button id="btn-online" class="mode-select-btn">
        <span class="icon">üåê</span>
        <span>–û–Ω–ª–∞–π–Ω</span>
        <span class="desc">–ò–≥—Ä–∞ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç</span>
      </button>
    </div>
    
    <div class="wins-section">
      <button id="show-wins-btn" class="secondary-btn">–¢–∞–±–ª–∏—Ü–∞ –ø–æ–±–µ–¥</button>
      <div id="wins-table" style="display:none;"></div>
    </div>
  </div>
  
  <!-- –≠–∫—Ä–∞–Ω –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ñ—Ñ–ª–∞–π–Ω –∏–≥—Ä—ã -->
  <div id="offline-setup" class="screen">
    <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ—Ñ—Ñ–ª–∞–π–Ω –∏–≥—Ä—ã</h2>
    
    <div class="player-selector">
      <div class="slider-group">
        <div class="slider-label">
          <span>üë§ –ò–≥—Ä–æ–∫–æ–≤:</span>
          <span class="slider-value" id="human-value">1</span>
        </div>
        <input type="range" id="human-players" min="1" max="4" value="1" step="1">
      </div>
      
      <div class="slider-group">
        <div class="slider-label">
          <span>ü§ñ –ë–æ—Ç–æ–≤:</span>
          <span class="slider-value" id="bot-value">0</span>
        </div>
        <input type="range" id="bot-count" min="0" max="7" value="0" step="1">
      </div>
    </div>
    
    <div class="mode-selection-section">
      <label>–†–µ–∂–∏–º –∏–≥—Ä—ã:</label>
      <div class="mode-selector">
        <button class="mode-btn active" data-mode="classic">–ö–ª–∞—Å—Å–∏–∫–∞</button>
        <button class="mode-btn" data-mode="magic-shooter">–ú–∞–≥–∏—á–µ—Å–∫–∏–π —à—É—Ç–µ—Ä</button>
      </div>
    </div>
    
    <div class="selected-mode-display">
      <span>–í—ã–±—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º:</span>
      <span class="mode-name" id="selected-mode-display">–ö–ª–∞—Å—Å–∏–∫–∞</span>
    </div>
    
    <div id="error-message" class="error-message"></div>
    
    <div class="button-group">
      <button id="controls-settings-btn" class="mode-select-btn controls-btn">
        <span class="icon">‚öôÔ∏è</span>
        <span>–ù–∞—Å—Ç—Ä–æ–∏—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</span>
        <span class="desc">–ò–∑–º–µ–Ω–∏—Ç—å –∫–ª–∞–≤–∏—à–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</span>
      </button>
    </div>
    
    <div class="button-group">
      <button id="start-offline-btn" class="primary-btn">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
      <button class="back-btn secondary-btn">–ù–∞–∑–∞–¥</button>
    </div>
  </div>
  
  <!-- –≠–∫—Ä–∞–Ω –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–Ω–ª–∞–π–Ω –∏–≥—Ä—ã -->
  <div id="online-setup" class="screen">
    <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–Ω–ª–∞–π–Ω –∏–≥—Ä—ã</h2>
    
    <div class="input-group">
      <label for="nickname-input">–í–∞—à –Ω–∏–∫:</label>
      <input type="text" id="nickname-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫" maxlength="20">
    </div>
    
    <div class="input-group">
      <label for="room-input">–ö–æ–¥ –∫–æ–º–Ω–∞—Ç—ã (–æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π):</label>
      <input type="text" id="room-input" placeholder="–ö–æ–¥ –∫–æ–º–Ω–∞—Ç—ã" maxlength="6">
    </div>
    
    <div class="input-group" id="local-players-group" style="display:none;">
      <label for="local-count">–ò–≥—Ä–æ–∫–æ–≤ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ:</label>
      <input type="number" id="local-count" min="1" max="4" value="1">
    </div>
    
    <div id="control-type-selector" style="display:none;">
      <label>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º:</label>
      <div class="radio-group">
        <label>
          <input type="radio" name="control-type" value="swipe" checked>
          <span>–°–≤–∞–π–ø—ã</span>
        </label>
        <label>
          <input type="radio" name="control-type" value="buttons">
          <span>–ö–Ω–æ–ø–∫–∏</span>
        </label>
      </div>
    </div>
    
    <div id="error-message-online" class="error-message"></div>
    
    <div class="button-group">
      <button id="join-room-btn" class="primary-btn">–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è</button>
      <button class="back-btn secondary-btn">–ù–∞–∑–∞–¥</button>
    </div>
  </div>
  
  <!-- –≠–∫—Ä–∞–Ω –ª–æ–±–±–∏ -->
  <div id="lobby-screen" class="screen">
    <h2>–ö–æ–º–Ω–∞—Ç–∞: <span id="room-code-display"></span></h2>
    
    <div class="lobby-info">
      <p>–ò–≥—Ä–æ–∫–∏ –≤ –∫–æ–º–Ω–∞—Ç–µ:</p>
      <div id="players-list" class="players-list"></div>
    </div>
    
    <div class="button-group">
      <button id="start-round-btn" class="primary-btn" style="display:none;">–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ä–∞—É–Ω–¥</button>
      <button id="leave-room-btn" class="secondary-btn">–ü–æ–∫–∏–Ω—É—Ç—å –∫–æ–º–Ω–∞—Ç—É</button>
    </div>
  </div>
  
  <!-- –ò–≥—Ä–æ–≤–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä -->
  <div id="game-container" style="display:none;">
    <button class="pause-btn" id="pause-btn" title="–ü–∞—É–∑–∞ (` –∏–ª–∏ —ë)">
      <span>‚è∏</span>
    </button>
    
    <canvas id="game-board"></canvas>
    
    <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö -->
    <div id="button-controls" style="display:none;">
      <button id="btn-up" class="control-btn">‚Üë</button>
      <button id="btn-left" class="control-btn">‚Üê</button>
      <button id="btn-down" class="control-btn">‚Üì</button>
      <button id="btn-right" class="control-btn">‚Üí</button>
    </div>
    
    <div id="game-over">
      <div class="game-over-content">
        <h2>–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!</h2>
        <p>–ü–æ–±–µ–¥–∏—Ç–µ–ª—å: <span id="winner">–ù–∏—á—å—è</span></p>
        <div id="final-scores"></div>
        <button id="play-again-btn" class="primary-btn">–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
      </div>
    </div>
  </div>
  
  <div id="scores" style="display:flex;flex-wrap:wrap;justify-content:center;gap:8px;margin:12px 0;"></div>
  <div id="legend" style="display:flex;flex-wrap:wrap;justify-content:center;gap:8px;margin:12px 0;"></div>
  
  <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Socket.IO -->
  <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
  
  <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –º–æ–¥—É–ª–µ–π -->
  <script src="/static/js/config.js"></script>
  <script src="/static/js/storage.js"></script>
  <script src="/static/js/renderer.js"></script>
  <script src="/static/js/controls.js"></script>
  <script src="/static/js/online.js"></script>
  <script src="/static/js/ui.js"></script>
  <script src="/static/js/main.js"></script>
</body>
</html>
